#
# Created by scaled
#

@name libprogram

function table exec(Name:string) {
    Program = object(Name)
    Ps:pushTable(Program)
    
    if (P:isValid()) {
        Program["parent", table] = P
    }
    
    return Program
}

function end() {
    if(Ps[KState, table] == P){
        Ps:removeTable(KState):clear()
        KState--
    }
    else {
        P:clear()
    }
    
    P = NULL
}

function table execUp(Name:string) {
    Ps:remove(KState)
    
    local Program = exec(Name)
    
    Ps:pushTable(P)
    KState = Ps:count()
    
    return Program
}
