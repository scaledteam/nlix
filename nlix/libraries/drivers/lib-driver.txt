#
# Created by scaled
#

@name lib-driver

function number driverInit(DriverName:string) {
    local App = programFindByName(DriverName)
    if (App != NULL) {
        varWrite(DriverName, App)
        return 1
    }
    else {
        return 0
    }
}

function table table:driverGetDevice() {
    return This:varTable("device")
}

#[function number driverPopDevice(DeviceType:string) {
    for (I = 1, ThisWorkspace:count()) {
        local Device = ThisWorkspace[I, table]
        if (Device:type() == DeviceType) {
            ThisWorkspace:remove(I)
            varWrite("device", Device)
            return 1
        }
    }
    return 0
}

function driverPushDevice() {
    ThisWorkspace:pushTable(varTable("device"))
}]#

function number driverPopDevice(DeviceType:string) {
    if (ThisProgram["devices", table]:count() == 0 & devicePop(DeviceType)) {
        varWrite("device", deviceGet())
        return 1
    }
    return 0
}

function driverPushDevice() {
    devicePush()
}
